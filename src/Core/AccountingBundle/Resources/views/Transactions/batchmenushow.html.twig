{# src/Core/AccountingBundle/Resources/views/Transactions/batchmenushow.html.twig #}
{% extends 'CoreAccountingBundle:Default:accounting.html.twig' %}

{% block title %}Accounting - Batch Journal Entries{% endblock %}

{% block navigation %}
    {{ parent() }}
{% endblock %}

{% block headtitle %}
Batch Journal Processing
{% endblock %}

{% block body %}
{% for flashMessage in app.session.flashbag.get('returnMessage') %}
<div class="row">
	<div class="alert alert-info" role="alert">
        {{ flashMessage }}
    </div>
</div>
<!-- /.row -->
{% endfor %}

<div class="row">
	<div class="col-lg-12">
		<div class="panel panel-default">
			<div class="panel-heading">
				Batch Journal Processing Menu
			</div>
			<!-- /.panel-heading -->
		</div>
	</div>
	<div class="col-lg-6">
		<div class="panel panel-default">
			<div class="panel-heading">
				Financial Account Batch
			</div>
			<!-- /.panel-heading -->
			<div class="panel-body">
				<div class="row">
					<button type="button" class="btn btn-primary" data-toggle="modal" 
							data-target="#monthproc" data-whatever="Month Start Processing">
						Month Start
					</button>
				</div>
				<div class="row">
					<button type="button" class="btn btn-primary" data-toggle="modal" 
							data-target="#monthproc" data-whatever="Month End Processing">
						Month End
					</button>
				</div>
				<div class="row">
					<button type="button" class="btn btn-primary" data-toggle="modal" 
							data-target="#batchfile" data-whatever="File-based Batch Processing">
						Batch File
					</button>
				</div>
			</div>
			<!-- /.panel-body for top section -->
		</div>
	</div>
	<div class="col-lg-6">
		<div class="panel panel-default">
			<div class="panel-heading">
				Investment Account Batch
			</div>
			<!-- /.panel-heading -->
			<div class="panel-body">
				<div class="row">
					<button type="button" class="btn btn-primary" data-toggle="modal" 
							data-target="#monthstart" data-whatever="@start">
						Investment Batch
					</button>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- /.row -->


<div class="modal fade" id="monthproc" tabindex="-1" role="dialog" aria-labelledby="monthprocLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="monthprocLabel">New Batch</h4>
			</div>
			<div class="modal-body">
				<table class="table table-striped table-bordered table-condensed">
					<thead>
						<th>Period Nbr.</th>
						<th>Period end date</th>
					</thead>
					<tbody>
					{% for period in periodrange %}
						<tr>
							<td>{{ period.periodnbr }}</td>
							<td>{{ period.lastdate }}</td>
							{% if period.periodnbr < next  %}
					    	<td><button class="btn btn-default" type="submit"><i class="fa fa-check-square-o"></i></button></td>
					    	<td>{{ period.periodnbr }} - {{ periodrange[3] }}</td>
					    	{% else %}
					    	<td><a class="btn btn-default" href="{{ path('CoreAccountingBundle_transactions_batch_edit',{'period':period.periodnbr}) }}">
					    		<i class="fa fa-square-o"></i>
					    	</a></td>
					    	{% endif %}
						</tr>
					{% endfor %}
					</tbody>
				</table>
			</div>
			<div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

{% endblock %}


{% block javascripts %}

{{ parent() }}

<script>
$('#monthproc').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  var recipient = button.data('whatever') // Extract info from data-* attributes
  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
  var modal = $(this)
  modal.find('.modal-title').text('Initiate ' + recipient)
})

{% endblock %}